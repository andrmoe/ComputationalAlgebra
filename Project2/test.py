from prime import exponentiate, fermat_test, trial_division_test, find_prime, find_prime_trial_division


def test_exponentiate():
    assert exponentiate(4, 3, 11) == 4


def test_primality_test():
    primes = [
        94887510009335069930554794250585216832556559623007766058403624171231089603254032670215367719265733371516330002656009571320719951341657745357097111516379322572625377669534563427153599949856107367731547,
        17903371126177025713795730492296853269741651517105882443289528336274095616609409619259935694208779471578140044919291906374936932280509240679354423754975308585658476122865378818965829456320816999176709,
        72991479337389139226775016558010076062380345006300869978372895667851617110425515578015131044852169293874476050138639270444443127011797829469506259418351339476107811814659742203727843381056134379873467,
        72557974545553044315921343492104966449984424988858016974535852587204355102834864706206636367364674996590949622618290912807935126400622386504562267192490616979037310173352708466351121254266733291904597,
        24554526073715828080963556773591941812861016304518274339490198941589806281847823486614940557004977419482519481445068372052006738927387981248225875679179565863452660125315401979337170492449029563231341,
        19183309688484347218121991411173464237540457184913933946210043693728121435193180552051931197875986630702567297797709809588695618713151326289594019905282992845486108640909358256918186233172332072440101,
        23285269831248362092522968442027670560052225983289382708520932615319248377757416190678536835527357901000652174190419404601027689077751690534940454777214727025224100641866627445410918339175283006204071,
    ]

    composites = [
        6306882407822665669617433534712852948768720684760596306493284365158611464903193891377198579016144077*1292363589494208019079417536114163851667396187680549491038089127744559155683711996448401942638419353,
        6228942811989721644716471567328872766748873380229601101866033983378504260829869072498602211331645923*7974245984171877235033502986629589939577618052212349425477486851544461231762171661599923670495892747,
        3988795130748272074376315816292042591880776130555354347556057700779415490285811647687654249831268771*7775211119108511174664832467258346851597261583839965842230587908431312481410967847417159452453419157,
        26655022554707471459487242345751900906641284673281*67270854345540710806585210549188600660537061791349*13679549020668256335584577005586102202957297013177*25748072877603346859334737446411108654623845964983,
        37719717998484153819493278296663211996441712750847*45883795274835363877727311955530997635620117080113*52109572704116844189850271192074831887806497421221*96713422408859002378288414183943147433226102112557,
        33986419039374862576238254728612401091291681043099*29541987844477789429557818140983970574772316172251*81817553316906619588101346787785395139868417903311*90496617717215696565559024642287065942581514189539,
        98648327273927255574628233153643703452210677368491**2*37951708187165715603344328825183215474844072816757**2
    ]

    # carmichael_numbers = [
    #     41041, 62745, 63973, 75361, 101101, 126217, 172081, 188461, 278545, 340561, 449065, 552721, 656601, 658801,
    #     670033, 748657, 838201, 852841, 997633, 1033669, 1082809, 1569457, 1773289, 2100901, 2113921, 2433601, 2455921
    # ]

    for prime in primes:
        assert fermat_test(prime)
        assert trial_division_test(prime)

    for composite in composites:
        assert not fermat_test(composite)
        assert not trial_division_test(composite)


def test_find_prime():
    n = 200
    for _ in range(3):
        prime = find_prime(n)
        assert (1 << n) <= prime < (1 << (n+1))
        assert fermat_test(prime)
        prime = find_prime_trial_division(n)
        assert (1 << n) <= prime < (1 << (n+1))
        assert fermat_test(prime)
